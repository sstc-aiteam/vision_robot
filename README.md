# Vision Robot
## 床單辨識與QR碼檢測系統
### 項目概述
本項目包含四個核心視覺處理系統：
1. **床單辨識系統** (main.py) - 使用 SAM2 進行床單的自動辨識與分割 
2. **QR碼檢測與尺寸分析系統** (paper_cut.py) - 基於 SAM2 的紙張分割與QR碼精確檢測 
3. **快速棉被檢測器** (yolo_v8.py) - 使用 YOLOv8 進行實時棉被/被子快速檢測
4. **實時深度分析系統** (camera_rgb_gray.py) - 基於 RealSense 和 SAM2 的實時物體深度檢測與分析

---

## 文件說明

### main.py - 床單辨識程式
**基於 SAM2 的精確床單分割系統**
- **Input**: 
  - 圖像文件路徑 (image_path) 
  - SAM2 模型檢查點文件 (checkpoint) 
  - 模型配置文件 (model_cfg) 
- **Output**: 
  - `simple_result_4.jpg` - 標註了邊界點和重心的結果圖像 
  - `simple_result_4_mask.png` - 分割遮罩圖像 
  - 控制台輸出邊界點坐標和重心坐標 
- **功能描述**: 
  此程式用於自動辨識圖像中的床單區域，並計算出床單的關鍵特徵點。主要功能：
  - 載入 SAM2 深度學習模型 
  - 對輸入圖像進行語義分割 
  - 自動找出目標物的上下左右邊界點 
  - 計算目標物的重心位置 
  - 在原圖上標註這些關鍵點並保存結果 
  - 生成分割遮罩用於後續處理 

---

### paper_cut.py - QR碼檢測與尺寸分析系統
**基於 SAM2 的高精度測量系統**
- **Input**: 
  - 包含A4紙張和QR碼的圖像文件 
  - SAM2 模型檢查點和配置文件 
  - QR碼標準尺寸參數 (默認53.5mm) 
- **Output**: 
  - 綜合分析結果圖表 (6宫格顯示) 
  - QR碼位置、尺寸和誤差分析報告 
  - 時間戳命名的結果保存文件 
- **功能描述**: 
  此程式用於進行精確的QR碼檢測和尺寸測量，主要功能：
  - **紙張分割**: 使用SAM2自動分割A4紙張區域 
  - **角點檢測**: 提取紙張的四個角點用於透視校正 
  - **DPI計算**: 根據A4標準尺寸計算圖像解析度 
  - **QR碼檢測**: 使用多種預處理方法檢測QR碼 
  - **透視校正**: 考慮紙張變形進行局部DPI校正 
  - **尺寸分析**: 計算QR碼實際尺寸並與標準值比較 
  - **誤差分析**: 生成詳細的測量誤差報告 
  - **視覺化結果**: 創建包含原圖、分割、檢測、分析的完整報告 

---

### yolo_v8.py - 快速棉被檢測器
**基於 YOLOv8 的實時物體檢測系統**
- **Input**: 
  - 圖像文件路徑 (支援各種常見格式)
  - 置信度閾值 (0.1-1.0，默認0.3)
  - YOLOv8 預訓練模型 (yolov8x-oiv7.pt)
- **Output**: 
  - `detection_result_[timestamp].jpg` - 帶有檢測框和標籤的結果圖像
  - 控制台輸出詳細檢測統計報告
  - 物體分類統計 (棉被/家具/其他)
- **功能描述**: 
  此程式是一個快速且用戶友好的棉被檢測工具，專門針對居家環境中的被褥識別：
  - **快速檢測**: 使用 YOLOv8x-OIV7 預訓練模型進行實時物體檢測
  - **智能分類**: 自動將檢測結果分為三大類：
    - 🛏️ **棉被相關**: blanket, quilt, comforter, duvet, throw
    - 🪑 **家具相關**: bed, couch, sofa, chair, furniture
    - 📦 **其他物體**: 其餘檢測到的物體
  - **結果可視化**: 自動在原圖上標註檢測框和標籤

---

### camera_rgb_gray.py - 實時深度分析系統
**基於 RealSense + SAM2 的實時物體深度檢測與分析系統**
- **Input**: 
  - Intel RealSense 相機 (彩色 + 深度流)
  - SAM2 模型檢查點文件 (checkpoint)
  - 模型配置文件 (model_cfg)
  - 相機參數 (解析度: 640x480, 幀率: 30fps)
- **Output**: 
  - 實時視窗顯示 (Auto Segmentation, Combined View, Depth Matrix)
  - `optimized_depth_matrix_[timestamp].txt` - 深度數值矩陣文件
- **功能描述**: 
  此程式是一個高度優化的實時深度視覺分析系統，整合了 3D 感知和 AI 分割技術：
  - **RealSense 相機控制**: 自動檢測設備、多重啟動機制、流對齊處理
  - **SAM2 實時分割**: 使用最新的 Segment Anything Model 2 進行物體分割
  - **深度數據處理**: 實時計算分割物體的深度統計 (平均/最小/最大值)
  - **多層次視覺化**: 深度熱力圖、四合一顯示、數值矩陣表格
  - **優化性能**: 非分割區域深度設為 0，節省計算資源
  - **互動控制**: ESC 退出、S 鍵保存深度矩陣

---

## 系統比較

| 特性 | main.py (SAM2) | paper_cut.py (SAM2) | yolo_v8.py (YOLOv8) | camera_rgb_gray.py (RealSense+SAM2) |
|------|----------------|---------------------|---------------------|--------------------------------------|
| **主要用途** | 床單精確分割 | QR碼尺寸測量 | 快速棉被檢測 | 實時深度分析與物體分割 |
| **輸入類型** | 靜態圖像 | 靜態圖像 | 靜態圖像 | 實時相機流 |
| **輸出類型** | 分割遮罩+關鍵點 | 測量報告+分析圖表 | 檢測框+分類統計 | 實時視覺化+深度數據 |
| **模型依賴** | SAM2 checkpoint | SAM2 checkpoint | YOLOv8 預訓練模型 | SAM2 + RealSense SDK |
| **執行方式** | 單次處理 | 單次處理 | 單次處理 | 連續實時處理 |
| **特殊硬體** | 無 | 無 | 無 | Intel RealSense 深度相機 |

---
